@{
    ViewData["Title"] = "Dashboard";
}

<div class="space-y-6">
    <!-- Page Header -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
            <p class="text-gray-600 mt-1">Welcome back, <strong>@User.Identity?.Name</strong></p>
        </div>
        <button type="button" class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium" id="refreshBtn" title="Refresh data">
            <i class="fas fa-sync-alt"></i>
            <span>Refresh</span>
        </button>
    </div>

    <!-- Quick Stats Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Total Users Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Total Users</p>
                    <h3 class="text-3xl font-bold text-blue-600 mt-2">1,248</h3>
                    <p class="text-sm text-gray-600 mt-2">
                        <i class="fas fa-arrow-up text-green-500"></i>
                        <span class="text-green-600 font-semibold">+12%</span> from last month
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 text-2xl">
                    <i class="fas fa-users"></i>
                </div>
            </div>
        </div>

        <!-- Active Trainers Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Active Trainers</p>
                    <h3 class="text-3xl font-bold text-green-600 mt-2">347</h3>
                    <p class="text-sm text-gray-600 mt-2">
                        <i class="fas fa-arrow-up text-green-500"></i>
                        <span class="text-green-600 font-semibold">+8%</span> from last month
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-green-100 flex items-center justify-center text-green-600 text-2xl">
                    <i class="fas fa-dumbbell"></i>
                </div>
            </div>
        </div>

        <!-- Active Subscriptions Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Active Subscriptions</p>
                    <h3 class="text-3xl font-bold text-green-600 mt-2">892</h3>
                    <p class="text-sm text-gray-600 mt-2">
                        <i class="fas fa-arrow-up text-green-500"></i>
                        <span class="text-green-600 font-semibold">+24%</span> from last month
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-green-100 flex items-center justify-center text-green-600 text-2xl">
                    <i class="fas fa-check-circle"></i>
                </div>
            </div>
        </div>

        <!-- Total Revenue Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Total Revenue</p>
                    <h3 class="text-3xl font-bold text-blue-600 mt-2">EGP 285.4K</h3>
                    <p class="text-sm text-gray-600 mt-2">
                        <i class="fas fa-arrow-up text-green-500"></i>
                        <span class="text-green-600 font-semibold">+15%</span> from last month
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 text-2xl">
                    <i class="fas fa-money-bill-wave"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Secondary Stats Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Pending Reviews Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Pending Reviews</p>
                    <h3 class="text-3xl font-bold text-red-600 mt-2">24</h3>
                    <p class="text-sm mt-2">
                        <a href="/admin/reviews" class="text-red-600 hover:text-red-700 font-medium">
                            View all <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-red-100 flex items-center justify-center text-red-600 text-2xl">
                    <i class="fas fa-star-half-alt"></i>
                </div>
            </div>
        </div>

        <!-- Unverified Trainers Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Unverified Trainers</p>
                    <h3 class="text-3xl font-bold text-amber-600 mt-2">18</h3>
                    <p class="text-sm mt-2">
                        <a href="/admin/trainers" class="text-amber-600 hover:text-amber-700 font-medium">
                            View all <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-amber-100 flex items-center justify-center text-amber-600 text-2xl">
                    <i class="fas fa-user-check"></i>
                </div>
            </div>
        </div>

        <!-- Failed Payments Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Failed Payments</p>
                    <h3 class="text-3xl font-bold text-red-600 mt-2">7</h3>
                    <p class="text-sm mt-2">
                        <a href="/admin/payments" class="text-red-600 hover:text-red-700 font-medium">
                            View all <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-red-100 flex items-center justify-center text-red-600 text-2xl">
                    <i class="fas fa-exclamation-circle"></i>
                </div>
            </div>
        </div>

        <!-- System Health Card -->
        <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-lg transition">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">System Health</p>
                    <h3 class="text-3xl font-bold text-green-600 mt-2">98%</h3>
                    <p class="text-sm text-gray-600 mt-2">
                        <i class="fas fa-check-circle text-green-500"></i> All systems operational
                    </p>
                </div>
                <div class="w-14 h-14 rounded-lg bg-green-100 flex items-center justify-center text-green-600 text-2xl">
                    <i class="fas fa-heartbeat"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Revenue Chart -->
        <div class="lg:col-span-2 bg-white rounded-lg border border-gray-200 overflow-hidden">
            <div class="border-b border-gray-200 p-6 flex justify-between items-center">
                <h5 class="text-lg font-semibold text-gray-900">Revenue Overview (Last 30 Days)</h5>
                <div class="flex gap-2">
                    <label class="inline-flex items-center">
                        <input type="radio" name="chartRange" value="7" class="w-4 h-4 text-blue-600">
                        <span class="ml-2 text-sm text-gray-600">7D</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="chartRange" value="30" checked class="w-4 h-4 text-blue-600">
                        <span class="ml-2 text-sm text-gray-600">30D</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="chartRange" value="90" class="w-4 h-4 text-blue-600">
                        <span class="ml-2 text-sm text-gray-600">90D</span>
                    </label>
                </div>
            </div>
            <div class="p-6">
                <div class="h-80">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Top Trainers -->
        <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
            <div class="border-b border-gray-200 p-6">
                <h5 class="text-lg font-semibold text-gray-900">Top Trainers</h5>
            </div>
            <div class="divide-y divide-gray-200">
                <div class="px-6 py-4 flex justify-between items-center hover:bg-gray-50">
                    <div>
                        <h6 class="font-semibold text-gray-900">Ahmed Hassan</h6>
                        <small class="text-gray-500">234 clients</small>
                    </div>
                    <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">4.9★</span>
                </div>
                <div class="px-6 py-4 flex justify-between items-center hover:bg-gray-50">
                    <div>
                        <h6 class="font-semibold text-gray-900">Fatima Noor</h6>
                        <small class="text-gray-500">187 clients</small>
                    </div>
                    <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">4.8★</span>
                </div>
                <div class="px-6 py-4 flex justify-between items-center hover:bg-gray-50">
                    <div>
                        <h6 class="font-semibold text-gray-900">Muhammad Ali</h6>
                        <small class="text-gray-500">156 clients</small>
                    </div>
                    <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">4.7★</span>
                </div>
                <div class="px-6 py-4 flex justify-between items-center hover:bg-gray-50">
                    <div>
                        <h6 class="font-semibold text-gray-900">Leila Ahmed</h6>
                        <small class="text-gray-500">142 clients</small>
                    </div>
                    <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">4.6★</span>
                </div>
                <div class="px-6 py-4 flex justify-between items-center hover:bg-gray-50">
                    <div>
                        <h6 class="font-semibold text-gray-900">Omar Ibrahim</h6>
                        <small class="text-gray-500">128 clients</small>
                    </div>
                    <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">4.5★</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity & Performance Row -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Recent Activity -->
        <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
            <div class="border-b border-gray-200 p-6">
                <h5 class="text-lg font-semibold text-gray-900">Recent Activity</h5>
            </div>
            <div class="divide-y divide-gray-200">
                <div class="p-4 flex gap-4 hover:bg-gray-50 transition">
                    <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0">
                        <i class="fas fa-user-plus text-lg"></i>
                    </div>
                    <div class="flex-grow">
                        <h6 class="font-semibold text-gray-900">New User Registration</h6>
                        <p class="text-sm text-gray-600 mt-1">Ahmed Mohammed registered as a new client</p>
                        <small class="text-gray-500">2 minutes ago</small>
                    </div>
                </div>
                <div class="p-4 flex gap-4 hover:bg-gray-50 transition">
                    <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 flex-shrink-0">
                        <i class="fas fa-money-bill-wave text-lg"></i>
                    </div>
                    <div class="flex-grow">
                        <h6 class="font-semibold text-gray-900">Payment Received</h6>
                        <p class="text-sm text-gray-600 mt-1">Payment of EGP 299 from Sarah Ali for subscription</p>
                        <small class="text-gray-500">5 minutes ago</small>
                    </div>
                </div>
                <div class="p-4 flex gap-4 hover:bg-gray-50 transition">
                    <div class="w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center text-amber-600 flex-shrink-0">
                        <i class="fas fa-star text-lg"></i>
                    </div>
                    <div class="flex-grow">
                        <h6 class="font-semibold text-gray-900">New Review Submitted</h6>
                        <p class="text-sm text-gray-600 mt-1">5-star review pending approval for Trainer Ahmed</p>
                        <small class="text-gray-500">15 minutes ago</small>
                    </div>
                </div>
                <div class="p-4 flex gap-4 hover:bg-gray-50 transition">
                    <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0">
                        <i class="fas fa-check-circle text-lg"></i>
                    </div>
                    <div class="flex-grow">
                        <h6 class="font-semibold text-gray-900">Trainer Verified</h6>
                        <p class="text-sm text-gray-600 mt-1">Fatima Noor has been verified as a trainer</p>
                        <small class="text-gray-500">1 hour ago</small>
                    </div>
                </div>
                <div class="p-4 flex gap-4 hover:bg-gray-50 transition">
                    <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600 flex-shrink-0">
                        <i class="fas fa-exclamation-circle text-lg"></i>
                    </div>
                    <div class="flex-grow">
                        <h6 class="font-semibold text-gray-900">Payment Failed</h6>
                        <p class="text-sm text-gray-600 mt-1">Payment of EGP 399 failed for Mohammed Hassan</p>
                        <small class="text-gray-500">2 hours ago</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Distribution & System Stats -->
        <div class="space-y-6">
            <!-- User Distribution -->
            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                <div class="border-b border-gray-200 p-6">
                    <h5 class="text-lg font-semibold text-gray-900">User Distribution</h5>
                </div>
                <div class="p-6">
                    <div class="h-48">
                        <canvas id="userDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                <div class="border-b border-gray-200 p-6">
                    <h5 class="text-lg font-semibold text-gray-900">Quick Actions</h5>
                </div>
                <div class="p-6 space-y-2">
                    <a href="/admin/users" class="flex items-center gap-3 w-full px-4 py-3 text-left text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition">
                        <i class="fas fa-users w-5"></i>
                        <span>Manage Users</span>
                    </a>
                    <a href="/admin/reviews" class="flex items-center gap-3 w-full px-4 py-3 text-left text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition">
                        <i class="fas fa-star w-5"></i>
                        <span>Approve Reviews (24)</span>
                    </a>
                    <a href="/admin/trainers" class="flex items-center gap-3 w-full px-4 py-3 text-left text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition">
                        <i class="fas fa-user-check w-5"></i>
                        <span>Verify Trainers (18)</span>
                    </a>
                    <a href="/admin/payments" class="flex items-center gap-3 w-full px-4 py-3 text-left text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition">
                        <i class="fas fa-credit-card w-5"></i>
                        <span>View Payments</span>
                    </a>
                    <a href="/admin/analytics" class="flex items-center gap-3 w-full px-4 py-3 text-left text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition">
                        <i class="fas fa-chart-bar w-5"></i>
                        <span>View Analytics</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Revenue Chart
        const revenueCtx = document.getElementById('revenueChart');
        if (revenueCtx) {
            const revenueChart = new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7', 'Day 8', 'Day 9', 'Day 10',
                        'Day 11', 'Day 12', 'Day 13', 'Day 14', 'Day 15', 'Day 16', 'Day 17', 'Day 18', 'Day 19', 'Day 20',
                        'Day 21', 'Day 22', 'Day 23', 'Day 24', 'Day 25', 'Day 26', 'Day 27', 'Day 28', 'Day 29', 'Day 30'],
                    datasets: [
                        {
                            label: 'Revenue (EGP)',
                            data: [8000, 9200, 7800, 10200, 11500, 9800, 12000, 11200, 13500, 12800,
                                14200, 13800, 15000, 14500, 16200, 15800, 17000, 16500, 18200, 17800,
                                19000, 18500, 20000, 19500, 21000, 20500, 22000, 21500, 23000, 22500],
                            borderColor: '#2563EB',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#2563EB',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                padding: 16,
                                font: { size: 13, weight: '500' },
                                color: '#6B7280'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#E5E7EB', drawTicks: false },
                            ticks: {
                                color: '#6B7280',
                                font: { size: 12 },
                                callback: function (value) {
                                    return 'EGP ' + value.toLocaleString();
                                }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { color: '#6B7280', font: { size: 12 } }
                        }
                    }
                }
            });
        }

        // User Distribution Chart
        const userDistributionCtx = document.getElementById('userDistributionChart');
        if (userDistributionCtx) {
            new Chart(userDistributionCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Clients', 'Trainers', 'Admins'],
                    datasets: [{
                        data: [901, 347, 0],
                        backgroundColor: [
                            'rgba(37, 99, 235, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(239, 68, 68, 0.8)'
                        ],
                        borderColor: ['#2563EB', '#22C55E', '#EF4444'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                boxWidth: 12,
                                padding: 16,
                                font: { size: 13, weight: '500' },
                                color: '#6B7280'
                            }
                        }
                    }
                });
        }

        // Refresh button
        document.getElementById('refreshBtn').addEventListener('click', function () {
            const btn = this;
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
            btn.disabled = true;

            setTimeout(() => {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }, 1500);
        });
    </script>
}
